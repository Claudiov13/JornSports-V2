<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Jorn Sports Analytics</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>JORN SPORTS</h1>
    <div class="subtitle">An√°lise Esportiva Avan√ßada</div>
  </div>

  <div class="error-message" id="errorMessage"></div>

  <div class="form-container">
    <!-- Perfil Biom√©trico -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-icon">üë§</div>
        <div class="section-title">Perfil Biom√©trico</div>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label" for="nome">Identifica√ß√£o do Atleta</label>
          <input type="text" id="nome" class="form-input" placeholder="Nome completo" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="idade">Idade Cronol√≥gica</label>
          <input type="number" id="idade" class="form-input" min="10" max="80" placeholder="Anos" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="sexo">Perfil Biol√≥gico</label>
          <select id="sexo" class="form-select" required>
            <option value="">Selecione o perfil...</option>
            <option value="masculino">Masculino</option>
            <option value="feminino">Feminino</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label" for="experiencia">N√≠vel de Expertise</label>
          <select id="experiencia" class="form-select" required>
            <option value="">Avalie sua experi√™ncia...</option>
            <option value="iniciante">Novato (0‚Äì1 ano)</option>
            <option value="intermediario">Desenvolvido (1‚Äì3 anos)</option>
            <option value="avancado">Avan√ßado (3+ anos)</option>
            <option value="atleta">Elite Competitiva</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Antropometria -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-icon">üìè</div>
        <div class="section-title">An√°lise Antropom√©trica</div>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label" for="altura">Estatura (cm)</label>
          <input type="number" id="altura" class="form-input" min="140" max="220" placeholder="Altura em cent√≠metros" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="peso">Massa Corporal (kg)</label>
          <input type="number" id="peso" class="form-input" min="35" max="200" step="0.1" placeholder="Peso em quilogramas" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="envergadura">Envergadura (cm) <span class="optional-label">(Opcional)</span></label>
          <input type="number" id="envergadura" class="form-input" min="140" max="250" placeholder="Abertura dos bra√ßos">
        </div>

        <div class="form-group">
          <label class="form-label" for="percentualGordura">Composi√ß√£o Corporal (%) <span class="optional-label">(Opcional)</span></label>
          <input type="number" id="percentualGordura" class="form-input" min="5" max="50" step="0.1" placeholder="% de gordura corporal">
        </div>
      </div>
    </div>

    <!-- Capacidades F√≠sicas -->
    <div class="form-section">
      <div class="section-header">
        <div class="section-icon">‚ö°</div>
        <div class="section-title">Capacidades F√≠sicas</div>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label" for="forca">Pot√™ncia/For√ßa</label>
          <select id="forca" class="form-select" required>
            <option value="">Avalie sua for√ßa...</option>
            <option value="1">1 - M√≠nima</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5 - M√©dia</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
            <option value="9">9</option><option value="10">10 - Elite</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label" for="resistencia">Sistema Cardiorrespirat√≥rio</label>
          <select id="resistencia" class="form-select" required>
            <option value="">Avalie sua resist√™ncia...</option>
            <option value="1">1 - M√≠nima</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5 - M√©dia</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
            <option value="9">9</option><option value="10">10 - Elite</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label" for="velocidade">Velocidade & Agilidade</label>
          <select id="velocidade" class="form-select" required>
            <option value="">Avalie sua velocidade...</option>
            <option value="1">1 - M√≠nima</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5 - M√©dia</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
            <option value="9">9</option><option value="10">10 - Elite</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label" for="flexibilidade">Flexibilidade</label>
          <select id="flexibilidade" class="form-select" required>
            <option value="">Avalie sua flexibilidade...</option>
            <option value="1">1 - M√≠nima</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5 - M√©dia</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
            <option value="9">9</option><option value="10">10 - Elite</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label" for="coordenacao">Coordena√ß√£o Motora</label>
          <select id="coordenacao" class="form-select" required>
            <option value="">Avalie sua coordena√ß√£o...</option>
            <option value="1">1 - M√≠nima</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5 - M√©dia</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
            <option value="9">9</option><option value="10">10 - Elite</option>
          </select>
        </div>
<Div>
</Div>
  <!-- Desempenho Espec√≠fico -->
<div class="form-section stack">
  <div class="section-header">
    <div class="section-icon">‚è±Ô∏è</div>
    <div class="section-title">Desempenho Espec√≠fico</div>
  </div>

  <div class="form-grid">
    <div class="form-group">
      <label class="form-label" for="distanciaFoco">Dist√¢ncia foco</label>
      <select id="distanciaFoco" class="form-select" required>
        <option value="">Selecione...</option>
        <option>50</option><option>100</option><option>200</option>
        <option>400</option><option>800</option><option>1500</option>
      </select>
    </div>

    <div class="form-group">
      <label class="form-label" for="t50">Tempo 50 m (s)</label>
      <input id="t50" class="form-input" type="number" step="0.01" min="15" max="200" placeholder="ex: 26.50" required>
    </div>

    <div class="form-group">
      <label class="form-label" for="t100">Tempo 100 m (s)</label>
      <input id="t100" class="form-input" type="number" step="0.01" min="30" max="400" placeholder="ex: 57.80" required>
    </div>

    <div class="form-group">
      <label class="form-label" for="t200">Tempo 200 m (s)</label>
      <input id="t200" class="form-input" type="number" step="0.01" min="60" max="1200" placeholder="ex: 130.00" required>
    </div>

    <div class="form-group">
      <label class="form-label" for="t400">Tempo 400 m (s)</label>
      <input id="t400" class="form-input" type="number" step="0.01" min="120" max="2400" placeholder="ex: 280.00" required>
    </div>

    <div class="form-group">
      <label class="form-label" for="tDolphin25">25 m Dolphin Kick (s) <span class="optional-label">(Opcional)</span></label>
      <input id="tDolphin25" class="form-input" type="number" step="0.01" min="8" max="60" placeholder="ex: 14.2">
    </div>

    <div class="form-group">
      <label class="form-label" for="tPeito25">25 m Pernada de Peito (s) <span class="optional-label">(Opcional)</span></label>
      <input id="tPeito25" class="form-input" type="number" step="0.01" min="10" max="80" placeholder="ex: 18.7">
    </div>

    <div class="form-group">
      <label class="form-label" for="mobOmbro">Mobilidade de Ombro (1‚Äì10)</label>
      <select id="mobOmbro" class="form-select" required>
        <option value="">Avalie...</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
      </select>
    </div>

    <div class="form-group">
      <label class="form-label" for="mobTornozelo">Mobilidade de Tornozelo (1‚Äì10)</label>
      <select id="mobTornozelo" class="form-select" required>
        <option value="">Avalie...</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
      </select>
    </div>
  </div>
</div>

<div class="privacy-note stack">
  <input type="checkbox" id="consent" style="transform: scale(1.2)" />
  <label for="consent">Autorizo salvar meus dados localmente neste navegador para continuar depois.</label>
</div>

<button class="analyze-btn stack" id="analisarBtn" type="button" onclick="analisarPerfil()">
  üèä ANALISAR ESTILO DE NATA√á√ÉO
</button>

  <!-- Resultados -->
  <div class="results" id="results">
    <div class="results-header">
      <h2>RELAT√ìRIO ‚Äî Estilo Recomendado</h2>
      <div class="subtitle">Compatibilidade por Crawl, Costas, Peito e Borboleta</div>
      <div class="results-actions">
        <button class="secondary-btn" id="editBtn">‚úèÔ∏è Editar respostas</button>
        <button class="secondary-btn" id="savePdfBtn">üñ®Ô∏è Exportar PDF</button>
      </div>
    </div>

    <div class="results-content" id="resultsContent">
      <div class="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Processando dados...</div>
      </div>

      <div class="chart-wrap" style="display:none">
        <canvas id="attrChart" width="680" height="340" aria-label="Comparativo de atributos" role="img"></canvas>
      </div>
      <div id="methodNote" class="method-note" aria-live="polite"></div>
    </div>
  </div>
</div>

<script>
/* ========= SAVE/RESTORE (v2, retrocompat√≠vel) ========= */
const FORM_STORAGE_KEY = "jornForm";
const FORM_VERSION = 2;

// Campos atuais do formul√°rio (inclui novos de desempenho/mobilidade)
const FIELDS_V2 = [
  "nome","idade","sexo","experiencia",
  "altura","peso","envergadura","percentualGordura",
  "forca","resistencia","velocidade","flexibilidade","coordenacao",
  // novos:
  "distanciaFoco","t50","t100","t200","t400","tDolphin25","tPeito25",
  "mobOmbro","mobTornozelo",
  // opcional: se voc√™ manteve ‚Äúconcentracao‚Äù para t√©cnica/consist√™ncia
  "concentracao"
];

// Campos antigos que podem existir no storage (ser√£o ignorados se n√£o houver input correspondente)
const LEGACY_FIELDS = ["competitividade","trabalhoEquipe","riscoTolerancia"];

// util: obt√©m valor de um campo se existir
function getVal(id){
  const el = document.getElementById(id);
  return el ? el.value : null;
}

// Salva somente se o consentimento estiver marcado
function saveForm(){
  const consent = document.getElementById('consent');
  if (!consent || !consent.checked) return;

  const data = { __version: FORM_VERSION, __ts: Date.now() };
  // salva os campos ‚Äúatuais‚Äù
  FIELDS_V2.forEach(id => { data[id] = getVal(id); });

  // se por acaso ainda existirem campos legados no DOM, salvamos tamb√©m (n√£o atrapalha)
  LEGACY_FIELDS.forEach(id => {
    const v = getVal(id);
    if (v !== null) data[id] = v;
  });

  localStorage.setItem(FORM_STORAGE_KEY, JSON.stringify(data));
}

// Restaura o que houver no storage, preenchendo somente elementos existentes no DOM
function restoreForm(){
  const raw = localStorage.getItem(FORM_STORAGE_KEY);
  if (!raw) return;
  try{
    const data = JSON.parse(raw);
    Object.entries(data).forEach(([k,v])=>{
      const el = document.getElementById(k);
      if (el != null && v != null) el.value = v;
    });
  }catch(e){
    // se algo der errado na leitura, n√£o faz nada
  }
}

// Auto-save: sempre que o usu√°rio alterar um input/select, tentamos salvar (se houver consentimento)
let _saveTimer = null;
function queueSave(){
  clearTimeout(_saveTimer);
  _saveTimer = setTimeout(saveForm, 250);
}

// Inicializa restaura√ß√£o e listeners
document.addEventListener("DOMContentLoaded", () => {
  restoreForm();

  // observa mudan√ßas em inputs/selects relevantes
  const selectors = [
    ".form-input","input[type='number']","input[type='text']",
    "select",".form-select"
  ];
  document.querySelectorAll(selectors.join(",")).forEach(el=>{
    el.addEventListener("input", queueSave);
    el.addEventListener("change", queueSave);
  });

  // se o usu√°rio marcar/desmarcar o consentimento, salva/para de salvar
  const consent = document.getElementById('consent');
  if (consent){
    consent.addEventListener("change", ()=>{
      if (consent.checked) saveForm(); // salva instantaneamente o estado atual
    });
  }
});
</script>
<script src="script.js"></script>
</body>
</html>
